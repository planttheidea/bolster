/*
 *
 * Copyright 2014 Tony Quetano under the terms of the MIT
 * license found at https://github.com/planttheidea/bolster/MIT_License.txt
 *
 * bolster_core.js - An augmentation library for jQuery
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
*/
(function(k,g,b,E){var l=function(a){throw Error(a);},G=function(){var a={audio:b.createElement("audio"),canvas:b.createElement("canvas"),document:b.documentElement||b.body,div:b.createElement("div"),input:b.createElement("input"),p:b.createElement("p"),style:b.createElement("style"),video:b.createElement("video")},h=function(c){try{for(var b=!1,e=c.length;e--;)if(c[e]in a.document.style){b=!0;break}return b}catch(d){return!1}},e=function(c,b){try{var e=a.div.style[c];a.div.style[c]=b;return e!==
a.div.style[c]?(a.div.style[c]="",!0):!1}catch(d){return!1}},f=function(c){return c in a.input},d=function(c){try{var b=a.input.type;a.input.type=c;return b!==a.input.type?(a.input.type="text",!0):!1}catch(e){return!1}},c=function(c){try{var e=b.head||b.getElementsByTagName("head")[0],d=a.style.sheet||a.style.styleSheet;a.style.type="text/css";e.appendChild(a.style);return d&&c?(K?function(a){d.cssText=a+" { }";return 0!==d.cssText.length&&!/unknown/i.test(d.cssText)&&0===d.cssText.indexOf(a)}:function(a){try{d.insertRule(a+
"{ }",0),d.deleteRule(d.cssRules.length-1)}catch(c){return!1}return!0})(c):!1}catch(f){return!1}};c("test");var t=!!g.applicationCache,n=a.div.attachEvent,u=!!a.audio.canPlayType,m=!(!a.audio.canPlayType||!a.audio.canPlayType("audio/mpeg;").replace(/no/,"")),l=!(!a.audio.canPlayType||!a.audio.canPlayType("audio/mp4;").replace(/no/,"")),v=!(!a.audio.canPlayType||!a.audio.canPlayType("audio/ogg;").replace(/no/,"")),w=h("boxShadow MozBoxShadow WebkitBoxShadow MsBoxShadow KhtmlBoxShadow OBoxShadow".split(" ")),
L=!(!a.canvas.getContext||!a.canvas.getContext("2d")),x=!!b.documentElement.classList,y;y=a.div.style.animationName?!0:h(["WebkitAnimationName","MozAnimationName","OAnimationName","msAnimationName","KhtmlAnimationName"]);var z=e("width","calc(100% - 10px)"),B=h(["columnCount","webkitColumnCount","MozColumnCount"]),A=h(["boxReflect","WebkitBoxRefect"]),K=!!a.style.styleSheet,M=!!g.CustomEvent,N=!!("draggable"in a.div),p=a.div.addEventListener,O=e("display","flex"),q=!!("geolocation"in navigator),r=
(b.documentElement||b.body).getBoundingClientRect,E=!!b.getElementsByClassName,G=function(c,b){try{return b=b||a.div,support=!1,c="on"+c,support=c in b,support||(b.setAttribute(c,"return;"),support="function"===k.type(b[c]),b.removeAttribute(c)),support}catch(d){return!1}}("hashchange",g),P=!(!g.history||!g.history.pushState),Q=e("background-color","hsla(0,0%,0%,0)"),R=function(){try{var a=["webkit","ms","moz"],c=!1;if(g.indexedDB&&g.IDBTransaction&&g.IDBKeyRange)c=!0;else for(var b=a.length;b--;)if(g[a[b]+
"IndexedDB"]&&g[a[b]+"IDBTransaction"]&&g[a[b]+"IDBKeyRange"]){c=!0;break}return c}catch(d){return!1}}(),S=f("autocomplete"),T=f("autofocus"),U=d("color"),V=d("date"),W=d("datetime"),X=d("datetime-local"),Y=d("email"),Z=f("list"),aa=f("max"),ba=f("min"),ca=f("multiple"),da=d("month"),ea=d("number"),fa=f("pattern"),ga=f("placeholder"),ha=d("range"),ia=f("required"),ja=d("search"),ka=f("step"),la=d("tel"),ma=d("time"),na=d("url"),oa=d("week"),pa=!(!JSON||"function"!==k.type(JSON.parse)),C;try{g.localStorage.setItem("test",
"test"),g.localStorage.removeItem("test"),C=!0}catch(Ra){C=!1}var H=function(){try{for(var a=["linear-gradient","-webkit-linear-gradient","-moz-linear-gradient","-o-linear-gradient"],c=!1,b=a.length;b--;)if(e("background",a[b]+"(-45deg,rgba(0,0,0,0) 0%,rgba(0,0,0,1) 100%)")){c=!0;break}return c?c:e("background","-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,0)),to(rgba(0,0,0,1)))")}catch(d){return!1}}(),qa=function(){try{var c=b.createElement("style"),d=!1;a.div.id="MediaTest";b.body.appendChild(a.div);
c.textContent="@media screen and (min-width:1px) { #MediaTest { position:absolute; }}";b.body.appendChild(c);g.getComputedStyle&&"absolute"==g.getComputedStyle(a.div).position&&(d=!0);a.div.style="";b.body.removeChild(a.div);b.body.removeChild(c);return d}catch(e){return!1}}(),ra=h(["opacity"]),sa="undefined"!==k.type(g.pageXOffset)&&"undefined"!==k.type(g.pageYOffset),ta=!!g.postMessage,ua=c(":active"),va=c(":after"),wa=c("::after"),xa=c(":before"),ya=c("::before"),za=c(":focus"),Aa=c(":hover"),
Ba=c("::first-letter"),Ca=c("::first-line"),Da=c(":link"),Ea=c(":visited"),I=function(){try{for(var a=["radial-gradient","-webkit-radial-gradient","-moz-radial-gradient","-o-radial-gradient"],c=!1,b=a.length;b--;)if(e("background",a[b]+"(rgb(0,0,0) 0%,rgb(255,255,255) 100%)")){c=!0;break}return c?c:e("background","-webkit-gradient(radial, center center, 0px, center center, 100%, from(rgb(0,0,0)), to(rgb(255,255,255)))")}catch(d){return!1}}(),Fa=e("background-color","rgba(0,0,0,0)"),D;try{g.sessionStorage.setItem("test",
"test"),g.sessionStorage.removeItem("test"),D=!0}catch(Sa){D=!1}var Ga=!!(b.createElementNS&&-1<b.createElementNS("http://www.w3.org/2000/svg","animateMotion").toString().indexOf("SVG")),Ha=!(!b.createElementNS||!b.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect),Ia=h(["textShadow"]),Ja=!!("ontouchstart"in b.documentElement||g.navigator.msMaxTouchPoints),F=h(["transform","WebkitTransform","MozTransform","msTransform","OTransform"]),J=function(){if(F)try{for(var a=["transform","WebkitTransform",
"MozTransform","msTransform","OTransform"],c=!1,b=a.length;b--;)if(e(a[b],"translate3d(1px,1px,1px)")){c=!0;break}return c}catch(d){return!1}else return!1}(),Ka=h(["transition","WebkitTransition","MozTransition","OTransition"]),La=!!a.video.canPlayType,Ma=!(!a.video.canPlayType||!a.video.canPlayType("video/mp4;").replace(/no/,"")),Na=!(!a.video.canPlayType||!a.video.canPlayType("video/ogg;").replace(/no/,"")),Oa=!(!a.video.canPlayType||!a.video.canPlayType("video/webm;").replace(/no/,"")),Pa=function(){try{var c=
!1;try{a.canvas.getContext("webgl"),c=!0}catch(b){try{a.getContext("experimental-webgl"),c=!0}catch(d){c=!1}}return c}catch(e){return!1}}(),Qa=!(!g.WebSocket||!g.WebSocket.prototype.send);(function(){var c=b.head||b.getElementsByTagName("head")[0];c.contains(a.style)&&c.removeChild(a.style)})();return{applicationCache:function(){return t},attachEvent:function(){return n},audio:function(){return u},audioMP3:function(){return m},audioMP4:function(){return l},audioOGG:function(){return v},boxShadow:function(){return w},
canvas:function(){return L},classList:function(){return x},cssAnimation:function(){return y},cssCalc:function(){return z},cssColumn:function(){return B},cssReflection:function(){return A},customEvent:function(){return M},dragAndDrop:function(){return N},eventListener:function(){return p},flexbox:function(){return O},geolocation:function(){return q},getBoundingClientRect:function(){return r},getElementsByClassName:function(){return E},gradient:function(){return{linear:H,radial:I}},hashchange:function(){return G},
history:function(){return P},hsla:function(){return Q},html5Attribute:function(){return{autocomplete:S,autofocus:T,list:Z,max:aa,min:ba,multiple:ca,pattern:fa,placeholder:ga,required:ia,step:ka}},html5Input:function(){return{color:U,date:V,dateTime:W,dateTimeLocal:X,email:Y,month:da,number:ea,range:ha,search:ja,tel:la,time:ma,url:na,week:oa}},indexedDB:function(){return R},json:function(){return pa},linearGradient:function(){return H},localStorage:function(){return C},mediaQueries:function(){return qa},
opacity:function(){return ra},pageOffset:function(){return sa},postMessage:function(){return ta},pseudoClass:function(){return{active:ua,after:va,before:xa,focus:za,hover:Aa,link:Da,visited:Ea}},pseudoElement:function(){return{after:wa,before:ya,firstLetter:Ba,firstLine:Ca}},radialGradient:function(){return I},rgba:function(){return Fa},sessionStorage:function(){return D},smil:function(){return Ga},storage:function(){return{local:C,session:D}},svg:function(){return Ha},textShadow:function(){return Ia},
touchEvents:function(){return Ja},transform:function(){return{twoD:F,threeD:J}},transform2d:function(){return F},transform3d:function(){return J},transition:function(){return Ka},video:function(){return La},videoMP4:function(){return Ma},videoOGG:function(){return Na},videoWebM:function(){return Oa},webGL:function(){return Pa},webSocket:function(){return Qa}}}(),m=function(){function a(a){if(0<f[a])for(var b in e)if(e[b])for(var d=e[b].length;d--;)e[b][d].token!==f[a]||e[b][d].persistent||(delete f[a],
e[b].splice(d,1))}function b(c,d,f,h,g){"array"!==k.type(e[c])&&(e[c]=[]);f&&(d=function(){d.call();a(h)});e[c].push({token:g,func:d})}var e={},f={};persistentIDs={};var d=-1;return{publish:function(a){var b=a.data||{},d,f;if(!e[a.topic])return!1;for(f=(d=e[a.topic])?d.length:0;f--;)d[f].func(b,a.topic);return this},subscribe:function(c){if("string"!==k.type(c.name))return l("Name passed is not a string."),!1;f[c.name]&&a(c.name);f[c.name]=++d;c.persistent&&(persistentIDs[c.name]=d);switch(k.type(c.topic)){case "string":b(c.topic,
c.fn,c.once,c.name,f[c.name]);break;case "array":for(var e=c.topic.length;e--;)b(c.topic[e],c.fn,c.once,c.name,f[c.name]);break;case "undefined":l("Must provide a topic to subscribe to.");break;default:l("Invalid topic type, must be either string or array.")}return this},unsubscribe:function(c){c=c||{};switch(k.type(c.name)){case "string":a(c.name);break;case "array":for(var b=c.name.length;b--;)a(c.name[b]);break;case "undefined":for(b in f)persistentIDs[b]||a(b);break;default:l("Name passed is not of valid type.")}return this}}}(),
p=function(){function a(a){return{fullscreenActive:p,fullscreenElement:u,hash:x,height:f,hostname:y,href:v,page:w,querystring:A,scrollTop:c,width:d}}function h(){x=r()}var e=k(g),f=e.height(),d=e.width(),c=e.scrollTop(),t=b.createElement("video"),n=function(){return t.requestFullScreen?{active:function(){return null!==b.fullscreenElement},element:function(){return b.fullscreenElement},enter:function(a){a.requestFullscreen()},exit:function(){b.exitFullscreen()}}:t.webkitRequestFullscreen?{active:function(){return null!==
b.webkitFullscreenElement},element:function(){return b.webkitFullscreenElement},enter:function(a){a.webkitRequestFullscreen()},exit:function(){b.webkitExitFullscreen()}}:t.mozRequestFullScreen?{active:function(){return null!==b.mozFullScreenElement},element:function(){return b.mozFullScreenElement},enter:function(a){a.mozRequestFullScreen()},exit:function(){b.mozCancelFullScreen()}}:t.msRequestFullscreen?{active:function(){return null!==b.msFullscreenElement},element:function(){return b.msFullscreenElement},
enter:function(a){a.msRequestFullscreen()},exit:function(){b.msExitFullscreen()}}:{active:function(){return!1},element:function(){return E},enter:function(){l("Fullscreen API is not supported.")},exit:function(){l("Fullscreen API is not supported.")}}}(),u=n.element(),p=n.active(),q=function(){return Array.prototype.lastIndexOf?function(a){return a.substring(a.lastIndexOf("/")+1).split("#")[0].split("?")[0]}:function(a){a=a.split("/");return a[a.length-1].split("#")[0].split("?")[0]}}(),v=g.location.href,
w=q(v),r=function(){return g.location.hash.replace("#","")},x=r,y=g.location.hostname||g.location.host,z=g.location.search.substr(1),B=function(){for(var a=z.split("&"),b={},c=0,d=a.length;c<d;c++){var e=a[c].split("=");0<e[0].length&&(b[e[0]]=e[1])}return b},A=B();e.off(".bolster.setWindowAttributes").on({"webkitfullscreenchange.bolster.setWindowAttributes mozfullscreenchange.bolster.setWindowAttributes fullscreenchange.bolster.setWindowAttributes MSFullscreenChange.bolster.setWindowAttributes":function(){u=
n.element();p=n.active();m.publish({topic:"fullscreenChange",data:{fullscreenActive:p,fullscreenElement:u}})},"load.bolster.setWindowAttributes":function(b){m.publish({topic:"windowLoad",data:a(b)})},"hashchange.bolster.setWindowAttributes":h,"resize.bolster.setWindowAttributes":function(){f=e.height();d=e.width();m.publish({topic:"windowResize",data:{height:f,width:d}})},"popstate.bolster.setWindowAttributes":function(a){m.publish({topic:"popstateChange",data:{event:a,originalState:a.originalEvent.state}});
h();v=g.location.href;z=g.location.search.substr(1);A=B();w=q(g.location.href)},"scroll.bolster.setWindowAttributes":function(){c=e.scrollTop();m.publish({topic:"windowScroll",data:{scrollTop:c}})}});return{attributes:a,dimensions:function(){return{width:d,height:f}},enterFullscreen:function(a){return n.enter(a)},exitFullscreen:function(){return n.exit()},fullscreenElement:function(){return u},hash:function(){return x},height:function(){return f},hostname:function(){return y},href:function(){return v},
isFullscreen:function(){return p},page:function(a){return a?q(a):w},querystring:function(a){return a?z:A},scrollTop:function(){return c},width:function(){return d},window:function(){return e}}}(),q=function(){function a(){return{anchors:b.anchors,characterSet:d,forms:b.forms,height:f,images:b.images,links:b.links,page:p.page(),referrer:l,styleSheets:g,styleSheetSets:n,title:b.title,uri:c,width:e}}var h=k(b),e=h.width(),f=h.height(),d=b.characterSet||b.charset,c=b.documentURI,g=b.styleSheets,n=b.styleSheetSets,
l=b.referrer;h.off(".bolster.setDocumentAttributes").on({"ready.bolster.setDocumentAttributes":function(){m.publish({topic:"documentReady",data:a()})},"resize.bolster.setDocumentAttributes":function(){e=h.width();f=h.height();m.publish({topic:"documentResize",data:{height:f,width:e}})}});return{anchors:function(){return b.anchors},attributes:a,characterSet:function(){return d},document:function(){return h},forms:function(){return b.forms},height:function(){return f},images:function(){return b.images},
links:function(){return b.links},referrer:function(){return l},styleSheets:function(){return g},styleSheetSets:function(){return n},title:function(){return b.title},uri:function(){return c},width:function(){return e}}}(),r={loadImg:function(a,b,e,f){if("function"===k.type(f)){var d=new Image;d.src=a.src;d.complete||4===d.readyState||"complete"===d.readyState?f.call(a,{height:a.height,naturalHeight:d.naturalHeight||d.height,naturalWidth:d.naturalWidth||d.width,percentComplete:Math.floor(100*(b+1)/
e),src:a.src,width:a.width}):(d.onload=function(){f.call(a,{height:a.height,naturalHeight:d.naturalHeight||d.height,naturalWidth:d.naturalWidth||d.width,percentComplete:Math.floor(100*(b+1)/e),src:a.src,width:a.width})},d.src=a.src)}}};k.extend({document:function(a,b){return a?q[a](b):q.document()},publish:function(a){return m.publish(a)},subscribe:function(a){return m.subscribe(a)},supports:function(a){return G[a]()},unsubscribe:function(a){return m.unsubscribe(a)},window:function(a,b){return a?
p[a](b):p.window()}});k.fn.extend({active:function(a){return this.hasClass(a||"active")},activate:function(a,b){a=a||"active";return b?this.deactivate(a,b).addClass(a):this.deactivate(a).addClass(a)},dataFilter:function(a,b){return"object"===k.type(a)?this.filter(function(){var b=k(this).data(),f,d;for(d in a)if(f=b.hasOwnProperty(d)&&b[d]===a[d],!f)break;return f}):this.filter(function(){return k(this).data(a)===val})},deactivate:function(a,b){a=a||"active";b?this.parents("."+b).find("."+a).removeClass(a):
this.parent().find("."+a).removeClass(a);return this},imgLoad:function(a,b){var e=this.length;return b&&0<b?this.each(function(f){var d=this;g.setTimeout(function(){r.loadImg(d,f,e,a)},b*f)}):this.each(function(b){r.loadImg(this,b,e,a)})},unselectable:function(a){(a?this:this.add(this.find("*"))).attr({unselectable:"on"}).css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"});return this},
unstyle:function(a){switch(k.type(a)){case "string":return this.css(a,"");case "array":for(var b={},e=a.length;e--;)b[a[e]]="";return this.css(b);case "undefined":return this.removeAttr("style");default:return l("Parameter passed in is not of appropriate type; processing aborted."),this}}})})(window.jQuery,window,document);
