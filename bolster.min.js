/*
 *
 * Copyright 2014 Tony Quetano under the terms of the MIT
 * license found at https://github.com/planttheidea/bolster/MIT_License.txt
 *
 * Bolster.js - An augmentation library for jQuery
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
*/
(function(h,g,k){var l=function(a){throw Error(a);},v=function(){var a={audio:g.createElement("audio"),canvas:g.createElement("canvas"),div:g.createElement("div"),input:g.createElement("input"),p:g.createElement("p"),style:g.createElement("style"),video:g.createElement("video")},d=function(b){try{for(var e=!1,c=b.length;c--;)if("undefined"!==a.div.style[b[c]]){e=!0;break}return e}catch(f){return!1}},b=function(b,e){try{var c=a.div.style[b];a.div.style[b]=e;return c!==a.div.style[b]?(a.div.style[b]=
"",!0):!1}catch(f){return!1}},c=function(b){return b in a.input},f=function(b){try{var e=a.input.type;a.input.type=b;return e!==a.input.type?(a.input.type="text",!0):!1}catch(c){return!1}},e=function(b){try{var e=g.head||g.getElementsByTagName("head")[0],c=a.style.sheet||a.style.styleSheet;a.style.type="text/css";e.appendChild(a.style);return c&&b?(E?function(a){c.cssText=a+" { }";return 0!==c.cssText.length&&!/unknown/i.test(c.cssText)&&0===c.cssText.indexOf(a)}:function(a){try{c.insertRule(a+"{ }",
0),c.deleteRule(c.cssRules.length-1)}catch(b){return!1}return!0})(b):!1}catch(f){return!1}};e("test");var n=!!h.applicationCache,p=a.div.attachEvent,w=!(!a.audio.canPlayType||!a.audio.canPlayType("audio/mpeg;").replace(/no/,"")),l=!(!a.audio.canPlayType||!a.audio.canPlayType("audio/mp4;").replace(/no/,"")),m=!(!a.audio.canPlayType||!a.audio.canPlayType("audio/ogg;").replace(/no/,"")),s=d("boxShadow MozBoxShadow WebkitBoxShadow MsBoxShadow KhtmlBoxShadow OBoxShadow".split(" ")),t=!(!a.canvas.getContext||
!a.canvas.getContext("2d")),v=!!g.documentElement.classList,x;x=a.div.style.animationName?!0:d(["WebkitAnimationName","MozAnimationName","OAnimationName","msAnimationName","KhtmlAnimationName"]);var F=b("width","calc(100% - 10px)"),G=d(["columnCount","webkitColumnCount","MozColumnCount"]),H=d(["boxReflect","WebkitBoxRefect"]),E=!!a.style.styleSheet,I=!!h.CustomEvent,J=!!("draggable"in a.div),K=a.div.addEventListener,L=b("display","flex"),M=!!("geolocation"in navigator),N=!!g.getElementsByClassName,
O=function(b,e){try{return e=e||a.div,support=!1,b="on"+b,support=b in e,support||(e.setAttribute(b,"return;"),support="function"===k.type(e[b]),e.removeAttribute(b)),support}catch(c){return!1}}("hashchange",h),P=!(!h.history||!h.history.pushState),Q=b("background-color","hsla(0,0%,0%,0)"),R=function(){try{var a=["webkit","ms","moz"],b=!1;if(h.indexedDB&&h.IDBTransaction&&h.IDBKeyRange)b=!0;else for(var e=a.length;e--;)if(h[a[e]+"IndexedDB"]&&h[a[e]+"IDBTransaction"]&&h[a[e]+"IDBKeyRange"]){b=!0;
break}return b}catch(c){return!1}}(),S=c("autocomplete"),T=c("autofocus"),U=f("color"),V=f("date"),W=f("datetime"),X=f("datetime-local"),Y=f("email"),Z=c("list"),$=c("max"),aa=c("min"),ba=c("multiple"),ca=f("month"),da=f("number"),ea=c("pattern"),fa=c("placeholder"),ga=f("range"),ha=c("required"),ia=f("search"),ja=c("step"),ka=f("tel"),la=f("time"),ma=f("url"),na=f("week"),q;try{h.localStorage.setItem("test","test"),h.localStorage.removeItem("test"),q=!0}catch(Ja){q=!1}var y=function(){try{for(var a=
["linear-gradient","-webkit-linear-gradient","-moz-linear-gradient","-o-linear-gradient"],e=!1,c=a.length;c--;)if(b("background",a[c]+"(-45deg,rgba(0,0,0,0) 0%,rgba(0,0,0,1) 100%)")){e=!0;break}return e?e:b("background","-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,0)),to(rgba(0,0,0,1)))")}catch(f){return!1}}(),oa=function(){try{var b=g.createElement("style"),e=!1;a.div.id="MediaTest";g.body.appendChild(a.div);b.textContent="@media screen and (min-width:1px) { #MediaTest { position:absolute; }}";
g.body.appendChild(b);h.getComputedStyle&&"absolute"==h.getComputedStyle(a.div).position&&(e=!0);a.div.style="";g.body.removeChild(a.div);g.body.removeChild(b);return e}catch(c){return!1}}(),pa="undefined"!==k.type(h.pageXOffset)&&"undefined"!==k.type(h.pageYOffset),qa=!!h.postMessage,ra=e(":active"),sa=e(":after"),ta=e("::after"),ua=e(":before"),va=e("::before"),wa=e(":focus"),xa=e(":hover"),ya=e("::first-letter"),za=e("::first-line"),Aa=e(":link"),Ba=e(":visited"),z=function(){try{for(var a=["radial-gradient",
"-webkit-radial-gradient","-moz-radial-gradient","-o-radial-gradient"],e=!1,c=a.length;c--;)if(b("background",a[c]+"(rgb(0,0,0) 0%,rgb(255,255,255) 100%)")){e=!0;break}return e?e:b("background","-webkit-gradient(radial, center center, 0px, center center, 100%, from(rgb(0,0,0)), to(rgb(255,255,255)))")}catch(f){return!1}}(),Ca=b("background-color","rgba(0,0,0,0)"),r;try{h.sessionStorage.setItem("test","test"),h.sessionStorage.removeItem("test"),r=!0}catch(Ka){r=!1}var Da=!!(-1<g.createElementNS("http://www.w3.org/2000/svg",
"animateMotion").toString().indexOf("SVG")),Ea=!(!g.createElementNS||!g.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect),Fa=d(["textShadow"]),Ga=!!("ontouchstart"in g.documentElement||h.navigator.msMaxTouchPoints),u=d(["transform","webkitTransform","MozTransform","msTransform","OTransform"]),A=function(){if(u)try{for(var a=["transform","webkitTransform","MozTransform","msTransform","OTransform"],e=!1,c=a.length;c--;)if(b(a[c],"translate3d(1px,1px,1px)")){e=!0;break}return e}catch(f){return!1}else return!1}(),
B=!(!a.video.canPlayType||!a.video.canPlayType("video/mp4;").replace(/no/,"")),C=!(!a.video.canPlayType||!a.video.canPlayType("video/ogg;").replace(/no/,"")),D=!(!a.video.canPlayType||!a.video.canPlayType("video/webm;").replace(/no/,"")),Ha=function(){try{var b=!1;try{a.canvas.getContext("webgl"),b=!0}catch(e){try{a.getContext("experimental-webgl"),b=!0}catch(c){b=!1}}return b}catch(f){return!1}}(),Ia=!(!h.WebSocket||!h.WebSocket.prototype.send);(function(){var b=g.head||g.getElementsByTagName("head")[0];
b.contains(a.style)&&b.removeChild(a.style)})();return{applicationCache:function(){return n},attachEvent:function(){return p},audio:function(){return{mp3:w,mp4:l,ogg:m}},audioMP3:function(){return w},audioMP4:function(){return l},audioOGG:function(){return m},boxShadow:function(){return s},canvas:function(){return t},classList:function(){return v},cssAnimation:function(){return x},cssCalc:function(){return F},cssColumn:function(){return G},cssReflection:function(){return H},customEvent:function(){return I},
dragAndDrop:function(){return J},eventListener:function(){return K},flexbox:function(){return L},geolocation:function(){return M},getElementsByClassName:function(){return N},gradient:function(){return{linear:y,radial:z}},hashchange:function(){return O},history:function(){return P},hsla:function(){return Q},html5Attribute:function(){return{autocomplete:S,autofocus:T,list:Z,max:$,min:aa,multiple:ba,pattern:ea,placeholder:fa,required:ha,step:ja}},html5Input:function(){return{color:U,date:V,dateTime:W,
dateTimeLocal:X,email:Y,month:ca,number:da,range:ga,search:ia,tel:ka,time:la,url:ma,week:na}},indexedDB:function(){return R},linearGradient:function(){return y},localStorage:function(){return q},mediaQueries:function(){return oa},pageOffset:function(){return pa},postMessage:function(){return qa},pseudoClass:function(){return{active:ra,after:sa,before:ua,focus:wa,hover:xa,link:Aa,visited:Ba}},pseudoElement:function(){return{after:ta,before:va,firstLetter:ya,firstLine:za}},radialGradient:function(){return z},
rgba:function(){return Ca},sessionStorage:function(){return r},smil:function(){return Da},storage:function(){return{local:q,session:r}},svg:function(){return Ea},textShadow:function(){return Fa},touchEvents:function(){return Ga},transform:function(){return{twoD:u,threeD:A}},transform2d:function(){return u},transform3d:function(){return A},video:function(){return{mp4:B,ogg:C,webM:D}},videoMP4:function(){return B},videoOGG:function(){return C},videoWebM:function(){return D},webGL:function(){return Ha},
webSocket:function(){return Ia}}}(),m=function(){function a(a){var f=c[a];if(0<f)for(var d in b)if(b[d])for(var g=b[d].length;g--;)b[d][g].token===f&&(c[a]&&delete c[a],b[d].splice(g,1))}function d(a,c,f){"array"!==k.type(b[a])&&(b[a]=[]);b[a].push({token:c,func:f})}var b={},c={},f=-1;return{getID:function(a){return c[a.name]},publish:function(a){var c=a.data||{},f,d;if(!b[a.topic])return!1;for(d=(f=b[a.topic])?f.length:0;d--;)f[d].func(c,a.topic);return this},subscribe:function(b){if("string"!==
k.type(b.name))return l("Name passed is not a string."),!1;c[b.name]&&a(b.name);b.token=++f;switch(k.type(b.topic)){case "string":d(b.topic,b.token,b.fn);break;case "array":for(var g=b.topic.length;g--;)d(b.topic[g],b.token,b.fn);break;case "undefined":l("Must provide a topic to subscribe to.");break;default:l("Invalid topic type, must be either string or array.")}c[b.name]=b.token;return this},unsubscribe:function(b){switch(k.type(b.name)){case "string":a(b.name);break;case "array":for(var c=b.name.length;c--;)a(b.name[c]);
break;default:l("Name passed is not of valid type.")}return this}}}(),s=function(){var a=k(h),d=a.height(),b=a.width(),c=a.scrollTop(),f=g.createElement("video"),e=function(){return f.requestFullScreen?{active:function(){return null!==g.fullscreenElement},element:function(){return g.fullscreenElement},enter:function(a){a.requestFullscreen()},exit:function(){g.exitFullscreen()}}:f.webkitRequestFullscreen?{active:function(){return null!==g.webkitFullscreenElement},element:function(){return g.webkitFullscreenElement},
enter:function(a){a.webkitRequestFullscreen()},exit:function(){g.webkitExitFullscreen()}}:f.mozRequestFullScreen?{active:function(){return null!==g.mozFullScreenElement},element:function(){return g.mozFullScreenElement},enter:function(a){a.mozRequestFullScreen()},exit:function(){g.mozCancelFullScreen()}}:f.msRequestFullscreen?{active:function(){return null!==g.msFullscreenElement},element:function(){return g.msFullscreenElement},enter:function(a){a.msRequestFullscreen()},exit:function(){g.msExitFullscreen()}}:
{active:function(){return!1},element:function(){},enter:function(){l("Fullscreen API is not supported.")},exit:function(){l("Fullscreen API is not supported.")}}}(),n=e.element(),p=e.active();a.off(".bolster.setWindowAttributes").on({"webkitfullscreenchange.bolster.setWindowAttributes mozfullscreenchange.bolster.setWindowAttributes fullscreenchange.bolster.setWindowAttributes MSFullscreenChange.bolster.setWindowAttributes":function(){n=e.element();p=e.active();m.publish({topic:"fullscreenChange",
data:{active:p,element:n}})},"load.bolster.setWindowAttributes":function(a){m.publish({topic:"windowLoad",data:{event:a,height:d,originalState:a.originalEvent.state,scrollTop:c,width:b}})},"resize.bolster.setWindowAttributes":function(){d=a.height();b=a.width();m.publish({topic:"windowResize",data:{height:d,width:b}})},"popstate.bolster.setWindowAttributes":function(a){m.publish({topic:"popstateChange",data:{event:a,originalState:a.originalEvent.state}})},"scroll.bolster.setWindowAttributes":function(){c=
a.scrollTop();m.publish({topic:"windowScroll",data:{scrollTop:c}})}});return{dimensions:function(){return{width:b,height:d}},enterFullscreen:function(a){return e.enter(a)},exitFullscreen:function(){return e.exit()},getFullscreenElement:function(){return n},height:function(){return d},isFullscreen:function(){return p},scrollTop:function(){return c},width:function(){return b},window:function(){return a}}}(),t=function(){var a=k(g),d=a.width(),b=a.height();a.off(".bolster.setDocumentAttributes").on({"load.bolster.setDocumentAttributes":function(){m.publish({topic:"documentLoad",
data:{width:d,height:b}})},"resize.bolster.setDocumentAttributes":function(){d=a.width();b=a.height();m.publish({topic:"documentResize",data:{width:d,height:b}})}});return{document:function(){return a},height:function(){return b},width:function(){return d}}}();pledge=function(){var a=function(){this.init=function(){this.resolved={};this.rejected={};this.cuid=this.puid=-1};this.resolve=function(a){this.cuid++;this.resolved[this.cuid]&&this.resolved[this.cuid].call(this,a)};this.reject=function(a){this.cuid++;
this.rejected[this.cuid]&&this.rejected[this.cuid].call(this,a)};this.push=function(a,c){this.puid++;"function"===k.type(a)?this.resolved[this.puid]=a:this.resolved[this.puid]=void 0;"function"===k.type(c)?this.rejected[this.puid]=c:this.rejected[this.puid]=function(a){l("Rejected: "+(a||""))}};this.init();return this},d=function(){var b=this;this.resolve=function(a){this.resolvePostpone=!0;this.resolveData=a};this.reject=function(a){this.rejectPostpone=!0;this.rejectData=a};this.pledge=function(){return(new a).start(function(){b.resolvePostpone?
this.resolve(b.resolveData):b.rejectPostpone&&this.reject(b.rejectData)})}};a.prototype={complete:function(a,c){this.push(a,c)},consecutive:function(a,c){for(var f="array"===k.type(c),e=a.length,d=0,e=a.length;d<e;d++)f?this.push(a[d],c[d]):this.push(a[d],c);return this},concurrent:function(b,c){if("undefined"===k.type(c)||"function"===k.type(c)){var f=function(b,c,f){(new a).start(function(){b.call(this,f)}).complete(function(a){d.push(a);d.length===e&&c.resolve(d)})},e=b.length,d=[];return this.proceed(function(a){for(var c=
b.length;c--;)f(b[c],this,a)},c)}this.init();l("Parameter passed is not a valid type for this method.")},proceed:function(a,c){this.push(a,c);return this},start:function(a){if("function"===k.type(a)){var c=this;h.setTimeout(function(){a.call(c)},0);return c}},wait:function(a,c){var d=this,e;a||l("Value of delay must be provided.");switch(k.type(c)){case "boolean":e=c;break;case "function":e=c();break;default:e=!0}return d.proceed(function(c){h.setTimeout(function(){e?d.resolve.call(d,c):d.reject.call(d,
"Test did not pass.")},a)})}};k.extend({pledge:function(b){if("function"===k.type(b))return(new a).start(b);l("Parameter passed is not a valid type for this method.")},postpone:function(){return new d}})}();helpFuncs={loadImg:function(a,d,b,c){if("function"===k.type(c)){var f=new Image;f.src=a.src;f.complete||4===f.readyState||"complete"===f.readyState?c.call(a,{height:a.height,naturalHeight:f.naturalHeight||f.height,naturalWidth:f.naturalWidth||f.width,percentComplete:Math.floor(100*(d+1)/b),src:a.src,
width:a.width}):(f.onload=function(){c.call(a,{height:a.height,naturalHeight:f.naturalHeight||f.height,naturalWidth:f.naturalWidth||f.width,percentComplete:Math.floor(100*(d+1)/b),src:a.src,width:a.width})},f.src=a.src)}},naturalDimensions:function(){return"naturalWidth"in new Image?function(a){var d=new Image;d.src=a.src;return{height:d.naturalHeight,width:d.naturalWidth}}:function(a){var d=new Image;d.src=a.src;d.onload=function(){return{height:this.height,width:this.width}}}}(),getPage:function(a){if(Array.prototype.lastIndexOf)return a.substring(a.lastIndexOf("/")+
1);a=a.split("/");return a[a.length-1].split("?")[0]}};k.extend({document:function(a){return a?t[a]():t.document()},page:function(a){return helpFuncs.getPage(a||h.location.href)},publish:function(a){return m.publish(a)},subscribe:function(a){return m.subscribe(a)},supports:function(a){return v[a]()},unsubscribe:function(a){return m.unsubscribe(a)},window:function(a,d){return a?s[a](d):s.window()}});k.fn.extend({active:function(a){return this.hasClass(a||"active")},activate:function(a,d){a=a||"active";
return d?this.deactivate(a,d).addClass(a):this.deactivate(a).addClass(a)},deactivate:function(a,d){a=a||"active";d?this.parents("."+d).find("."+a).removeClass(a):this.parent().find("."+a).removeClass(a);return this},imgLoad:function(a,d){var b=this.length;return d&&0<d?this.each(function(c){var f=this;h.setTimeout(function(){helpFuncs.loadImg(f,c,b,a)},d*c)}):this.each(function(c){helpFuncs.loadImg(this,c,b,a)})},naturalHeight:function(){return helpFuncs.naturalDimensions(this.get(0)).height},naturalWidth:function(){return helpFuncs.naturalDimensions(this.get(0)).width},
unselectable:function(a){(a?this:this.add(this.find("*"))).attr({unselectable:"on"}).css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"});return this},unstyle:function(a){switch(k.type(a)){case "string":return this.css(a,"");case "array":for(var d={},b=a.length;b--;)d[a[b]]="";return this.css(d);case "undefined":return this.removeAttr("style");default:return throwwError("Parameter passed in is not of appropriate type; processing aborted."),
this}}})})(window,document,jQuery);
